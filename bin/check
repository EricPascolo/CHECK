#!/usr/bin/env python

#
# CHECK
#
# @authors : Eric Pascolo
#
# Copyright (C) 2017 B.U HPC - CINECA
#
#

from __future__ import print_function
from checklib.inout import commandline
from checklib.setting import checkobj
import sys
import os
import logging

__author__ = "Eric Pascolo"
__copyright__ = "Copyright 2017, B.U HPC - CINECA"
__credits__ = [""]
__license__ = "GNU Affero GPL v.3"
__version__ = "0.1"
__email__ = "simone.bna@cineca.it"
__status__ = "Development"

if sys.version_info[:2] < (2,7):
    v_info = sys.version_info[:3]
    sys.exit("CHECK requires Python 2.7 or higher."
             "This is Python %d.%d.%d." % v_info)


##read commandline flag
cl_args = commandline.cl_convert_to_dict(commandline.cl_parser())

##init check setting object
setting = checkobj.check_setting(cl_args)



## master
if cl_args["master"]:
    from checklib.master import master_runner
    master_runner.main(setting)

## daemon 
elif cl_args["daemon"]:
    from checklib.daemon import daemon_manager
    Dcheck = daemon_manager.deamon_manager(setting)
    Dcheck.command(cl_args)

## slave
else:
    from checklib.slave import slave_runner
    slave_runner.main(setting)
